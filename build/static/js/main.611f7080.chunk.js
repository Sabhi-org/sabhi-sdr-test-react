(this["webpackJsonpsdr-form"]=this["webpackJsonpsdr-form"]||[]).push([[0],{112:function(e,t,a){},179:function(e,t,a){},308:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a(25),c=a.n(r),i=(a(179),a(21)),s=a(17),o=a.n(s),l=a(26),d=a.p+"static/media/dark.e4d8b6e7.svg",u=(a(112),a(4));function m(){var e=Object(i.f)();return Object(n.useEffect)((function(){var t=setTimeout(Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.push("/onboard");case 1:case"end":return t.stop()}}),t)}))),3e3);return function(){clearInterval(t)}}),[]),Object(u.jsx)("div",{class:"container",style:{display:"inline-flex",justifyContent:"center",alignItems:"center",width:"500px"},children:Object(u.jsx)("img",{src:d,width:"200px"})})}var p=a(42),h=a(315),b=a(316),j=a(168),g=a(34);function f(){var e=localStorage.getItem("DID"),t=Object(i.f)(),a=h.a.useForm(),r=Object(p.a)(a,1)[0],c=Object(n.useState)("false"),s=Object(p.a)(c,2),d=(s[0],s[1]),m=Object(n.useState)({}),f=Object(p.a)(m,2),O=f[0],x=f[1],y=function(){var t=Object(l.a)(o.a.mark((function t(){var a,n,c,i,s,l,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,d(!0),t.next=4,g.sabhiApiInstance.get("ocr/".concat(e));case 4:a=t.sent,n=a.data.data[0],c=n.identityCardFrontData,i=n.identityCardBackData,s=n.profileImage,l=n.identityCardFrontImage,u=n.identityCardBackImage,x({profileImage:s,identityCardFrontImage:l,identityCardBackImage:u}),r.setFieldsValue({fullName:c.nameEnglish,fatherName:c.fatherNameEnglish,gender:c.gender,countryOfStay:c.countryOfStay,identityNumber:c.identityNumber,issueDate:c.dateOfIssue,birthDate:c.dateOfBirth,expireDate:c.dateOfExpiry,permanentAddress:i.permenantAddress,temporaryAddress:i.presentAddress}),d(!1),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(){return t.apply(this,arguments)}}();Object(n.useEffect)((function(){y()}),[]);var v=function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.apiInstance.post("vp",t);case 3:e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsxs)(h.a,{layout:"horizontal",form:r,name:"basic",onFinish:function(a){console.log(a),d(!0),a.profileImage=O.profileImage,a.did=e,a.identityCardBackImage=O.identityCardBackImage,a.identityCardFrontImage=O.identityCardFrontImage,v(a),d(!1),t.push({pathname:"/user_profile"})},onFinishFailed:function(e){console.log("Failed:",e)},children:[Object(u.jsx)(h.a.Item,{label:"Name",required:!0,tooltip:"This is a required field",name:"fullName",children:Object(u.jsx)(b.a,{placeholder:"input placeholder"})}),Object(u.jsx)(h.a.Item,{label:"Father Name",required:!0,tooltip:"This is a required field",name:"fatherName",children:Object(u.jsx)(b.a,{placeholder:"input placeholder"})}),Object(u.jsx)(h.a.Item,{label:"Gender",required:!0,tooltip:"This is a required field",name:"gender",children:Object(u.jsx)(b.a,{placeholder:"input placeholder"})}),Object(u.jsx)(h.a.Item,{label:"Country of Stay",required:!0,tooltip:"This is a required field",name:"countryOfStay",children:Object(u.jsx)(b.a,{placeholder:"input placeholder"})}),Object(u.jsx)(h.a.Item,{label:"Identity Number",required:!0,tooltip:"This is a required field",name:"identityNumber",children:Object(u.jsx)(b.a,{placeholder:"input placeholder"})}),Object(u.jsx)(h.a.Item,{label:"Date of Issue",required:!0,tooltip:"This is a required field",name:"issueDate",children:Object(u.jsx)(b.a,{placeholder:"input placeholder"})}),Object(u.jsx)(h.a.Item,{label:"Date of Birth",required:!0,tooltip:"This is a required field",name:"birthDate",children:Object(u.jsx)(b.a,{placeholder:"input placeholder"})}),Object(u.jsx)(h.a.Item,{label:"Date of Expiry",required:!0,tooltip:"This is a required field",name:"expireDate",children:Object(u.jsx)(b.a,{placeholder:"input placeholder"})}),Object(u.jsx)(h.a.Item,{label:"Permanent Address",required:!0,tooltip:"This is a required field",name:"permanentAddress",children:Object(u.jsx)(b.a,{placeholder:"input placeholder"})}),Object(u.jsx)(h.a.Item,{label:"Temporary Address",required:!0,tooltip:"This is a required field",name:"temporaryAddress",children:Object(u.jsx)(b.a,{placeholder:"input placeholder"})}),Object(u.jsx)(h.a.Item,{children:Object(u.jsx)(j.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})}var O=a(169),x=a(318),y=a(311),v=a(312),I=a(313),w=a(317),S=a(314),k=a(165),D=a(122),N=a.n(D);function E(){var e,t=localStorage.getItem("DID");console.log(localStorage.getItem("DID"));var a=Object(n.useState)(""),r=Object(p.a)(a,2),c=(r[0],r[1]),i=h.a.useForm(),s=Object(p.a)(i,1)[0],d=Object(n.useState)("false"),m=Object(p.a)(d,2),j=m[0],f=m[1],D=Object(n.useState)(null),E=Object(p.a)(D,2),C=(E[0],E[1],Object(n.useState)({})),B=Object(p.a)(C,2),A=B[0],q=B[1];Object(n.useEffect)((function(){!function(){P.apply(this,arguments)}()}),[]);var U,T="";function P(){return(P=Object(l.a)(o.a.mark((function e(){var a,n,r,c,i,l,d,u,m,p,h,b,j;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,f(!0),e.next=4,g.sabhiApiInstance.get("application/".concat(t));case 4:a=e.sent,console.log(a.data.data[0]),n=a.data.data[0],r=n.fullName,c=n.fatherName,i=n.profileImage,l=n.countryOfStay,d=n.gender,u=n.identityNumber,m=n.issueDate,p=n.birthDate,h=n.expireDate,b=n.permanentAddress,j=n.temporaryAddress,q({profileImage:i}),s.setFieldsValue({fullName:r.value,fatherName:c.value,gender:d.value,countryOfStay:l.value,identityNumber:u.value,issueDate:m.value,birthDate:p.value,expireDate:h.value,permanentAddress:b.value,temporaryAddress:j.value}),f(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),O.b.error("something went wrong!",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}return Object(n.useEffect)((function(){U=Object(k.io)("http://localhost:12345/"),console.log(U),U.on("chat",(function(e){console.log(e)})),U.on("displayOmniCheck",(function(e){console.log(e),T=e.message,c(e.message),function(){var e=N.a.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1});e.fire({title:"Please confirm following",html:"".concat(T),allowOutsideClick:!1,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, it is me",cancelButtonText:"No,it is not me",reverseButtons:!0}).then((function(t){t.isConfirmed?(console.log("i am confirmed !!! "),U.emit("omniResponse",{status:!0,message:"omni is accepted!"}),e.fire("Confirmed!","Your data has been confirmed","success")):t.dismiss===N.a.DismissReason.cancel&&(console.log("i am rejected !!!"),U.emit("omniResponse",{status:!1,message:"omni is rejected!"}),e.fire("Cancelled","Your data could not be confirmed :(","error"))}))}()}))}),[]),Object(u.jsx)("div",{children:Object(u.jsx)(x.b,{size:"large",children:Object(u.jsxs)(y.a,{spinning:j,children:[Object(u.jsxs)(h.a,{style:{marginTop:"18px"},layout:"vertical",form:s,name:"basic",children:[Object(u.jsxs)(v.a,{children:[Object(u.jsx)(I.a,{span:4,children:Object(u.jsx)(w.a,{style:{marginTop:"18px"},src:Object(u.jsx)(S.a,{src:null!==(e=A.profileImage)&&void 0!==e?e:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"}),size:140})}),Object(u.jsxs)(I.a,{span:20,children:[Object(u.jsxs)(v.a,{gutter:16,children:[Object(u.jsx)(I.a,{className:"gutter-row",span:2}),Object(u.jsx)(I.a,{className:"gutter-row",span:11,children:Object(u.jsx)(h.a.Item,{label:"Name",name:"fullName",children:Object(u.jsx)(b.a,{size:"small",disabled:!0})})}),Object(u.jsx)(I.a,{className:"gutter-row",span:11,children:Object(u.jsx)(h.a.Item,{label:"Father Name",name:"fatherName",children:Object(u.jsx)(b.a,{size:"small",disabled:!0})})})]}),Object(u.jsxs)(v.a,{gutter:16,offset:4,children:[Object(u.jsx)(I.a,{className:"gutter-row",span:2}),Object(u.jsx)(I.a,{className:"gutter-row",span:11,children:Object(u.jsx)(h.a.Item,{label:"Gender",name:"gender",children:Object(u.jsx)(b.a,{size:"small",disabled:!0})})}),Object(u.jsx)(I.a,{className:"gutter-row",span:11,children:Object(u.jsx)(h.a.Item,{label:"Country of Stay",name:"countryOfStay",children:Object(u.jsx)(b.a,{size:"small",disabled:!0})})}),Object(u.jsx)(I.a,{className:"gutter-row",span:6})]})]})]}),Object(u.jsxs)(v.a,{children:[Object(u.jsxs)(v.a,{gutter:22,children:[Object(u.jsx)(I.a,{className:"gutter-row",span:6,children:Object(u.jsx)(h.a.Item,{label:"Identity Number",name:"identityNumber",children:Object(u.jsx)(b.a,{size:"small",disabled:!0})})}),Object(u.jsx)(I.a,{className:"gutter-row",span:6,children:Object(u.jsx)(h.a.Item,{label:"Date of Issue",name:"issueDate",children:Object(u.jsx)(b.a,{size:"small",disabled:!0})})}),Object(u.jsx)(I.a,{className:"gutter-row",span:6,children:Object(u.jsx)(h.a.Item,{label:"Date of Birth",name:"birthDate",children:Object(u.jsx)(b.a,{size:"small",disabled:!0})})}),Object(u.jsx)(I.a,{className:"gutter-row",span:6,children:Object(u.jsx)(h.a.Item,{label:"Date of Expiry",name:"expireDate",children:Object(u.jsx)(b.a,{size:"small",disabled:!0})})})]}),Object(u.jsxs)(I.a,{span:24,children:[Object(u.jsx)(h.a.Item,{label:"Permanent Address",name:"permanentAddress",children:Object(u.jsx)(b.a,{size:"small",disabled:!0})}),Object(u.jsx)(h.a.Item,{label:"Temporary Address",name:"temporaryAddress",children:Object(u.jsx)(b.a,{size:"small",disabled:!0})})]})]})]}),Object(u.jsx)(v.a,{children:"Verified By: XYZ"})]})})})}var C=a.p+"static/media/onboarding.80f4a645.png";function B(){var e=Object(i.f)(),t=function(){var t=Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{O.b.loading("creating identity...",.5).then(Object(l.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.apiInstance.get("did");case 2:(a=t.sent)&&(localStorage.setItem("DID",a.data.did),console.log(localStorage.getItem("DID")),O.b.success("Identity created succesfully!").then((function(){return O.b.loading("redirecting...",1).then((function(){return e.push("/ocr_front")}))})));case 4:case"end":return t.stop()}}),t)}))))}catch(a){O.b.error("something went wrong please try again!")}case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(u.jsxs)("div",{class:"container",style:{display:"inline-flex",justifyContent:"center",alignItems:"center",width:"500px",height:"500px"},children:[Object(u.jsx)("img",{src:C,width:"200px"}),Object(u.jsx)(j.a,{type:"primary",shape:"round",style:{position:"absolute",top:"550px",background:"#4DDFBC",bordeRadius:"16px",borderColor:"#4DDFBC"},size:"large",onClick:t,children:"Create Identity"})]})}var A=a(66),q=a(67),U=a(103),T=a(101),P=function(){function e(t,a){Object(A.a)(this,e),this.webcamElement=t,this.canvasElement=a}return Object(q.a)(e,[{key:"adjustVideoSize",value:function(e,t){var a=e/t;e>=t?this.webcamElement.width=a*this.webcamElement.height:e<t&&(this.webcamElement.height=this.webcamElement.width/a)}},{key:"setup",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){void 0!==navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}}).then((function(e){"srcObject"in t.webcamElement?(t.webcamElement.srcObject=e,console.log("here")):t.webcamElement.src=window.URL.createObjectURL(e),t.webcamElement.onloadedmetadata=function(e){t.webcamElement.play()}})):a()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_drawImage",value:function(){var e=this.webcamElement.videoWidth,t=this.webcamElement.videoHeight,a=this.canvasElement.getContext("2d");return this.canvasElement.width=e,this.canvasElement.height=t,a.drawImage(this.webcamElement,0,0,e,t),{imageHeight:t,imageWidth:e}}},{key:"takeBlobPhoto",value:function(){var e=this,t=this._drawImage(),a=t.imageWidth,n=t.imageHeight;return new Promise((function(t,r){e.canvasElement.toBlob((function(e){t({blob:e,imageHeight:n,imageWidth:a})}))}))}},{key:"takeBase64Photo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"png",quality:1},t=e.type,a=e.quality,n=this._drawImage(),r=n.imageHeight,c=n.imageWidth,i=this.canvasElement.toDataURL("image/"+t,a);return{base64:i,imageHeight:r,imageWidth:c}}}]),e}(),F=function(e){Object(U.a)(a,e);var t=Object(T.a)(a);function a(){var e;return Object(A.a)(this,a),(e=t.call(this)).captureImage=Object(l.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.webcam.takeBase64Photo({type:"jpeg",quality:.8}),console.log(a.base64),e.setState({captured:!0,capturedImage:a.base64});case 3:case"end":return t.stop()}}),t)}))),e.discardImage=function(){e.setState({captured:!1,capturedImage:null})},e.uploadImage=function(){if(e.props.offline){console.log("you're using in offline mode sha");var t=Math.random().toString(36).substr(2,5);localStorage.setItem("".concat("cloudy_pwa_").concat(t),e.state.capturedImage),alert("Image saved locally, it will be uploaded to your Sabhi media library once internet connection is detected"),e.discardImage()}else e.setState({uploading:!0}),g.sabhiApiInstance.post("ocr/cnic/front",{file:e.state.capturedImage,did:localStorage.getItem("DID")}).then((function(t){return e.checkUploadStatus(t)})).catch((function(t){alert("Sorry, we encountered an error uploading your image"),e.setState({uploading:!1})}))},e.findLocalItems=function(e){var t,a=[];for(t in localStorage)if(localStorage.hasOwnProperty(t)&&(t.match(e)||!e&&"string"===typeof t)){var n=localStorage.getItem(t);a.push({key:t,val:n})}return a},e.checkUploadStatus=function(t){e.setState({uploading:!1}),200===t.status?(alert("Image Uploaded to Sabhi Media Library"),e.props.history.push("/ocr_back"),e.discardImage()):alert("Sorry, we encountered an error uploading your image")},e.batchUploads=function(){var t=e.findLocalItems(/^cloudy_pwa_/);if(t.length>0){e.setState({uploading:!0});for(var a=0;a<t.length;a++)g.sabhiApiInstance.post("ocr/cnic/front",{file:t[a].val,did:localStorage.getItem("DID")}).then((function(t){return e.checkUploadStatus(t)})).catch((function(e){!0}));e.setState({uploading:!1}),alert("All saved images have been uploaded to your Sabhi Media Library")}},e.webcam=null,e.state={capturedImage:null,captured:!1,uploading:!1},e}return Object(q.a)(a,[{key:"componentDidMount",value:function(){this.canvasElement=document.createElement("canvas"),this.webcam=new P(document.getElementById("webcam"),this.canvasElement),this.webcam.setup().catch((function(){alert("Error getting access to your camera")}))}},{key:"componentDidUpdate",value:function(e){this.props.offline||!0!==e.offline||this.batchUploads()}},{key:"render",value:function(){var e={};this.state.captured&&(e.display="none");var t=this.state.capturedImage?Object(u.jsx)("img",{src:this.state.capturedImage,alt:"captured",width:"350"}):Object(u.jsx)("span",{}),a=this.state.captured?Object(u.jsxs)("div",{children:[Object(u.jsx)("button",{className:"deleteButton",onClick:this.discardImage,children:" Delete Photo "}),Object(u.jsx)("button",{className:"captureButton",onClick:this.uploadImage,children:" Upload Photo "})]}):Object(u.jsx)("button",{className:"captureButton",onClick:this.captureImage,children:" Take Picture "}),n=this.state.uploading?Object(u.jsx)("div",{children:Object(u.jsx)("p",{children:" Uploading Image, please wait ... "})}):Object(u.jsx)("span",{});return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:" Front"}),n,Object(u.jsx)("video",{autoPlay:!0,playsInline:!0,muted:!0,id:"webcam",width:"100%",style:e}),Object(u.jsx)("br",{}),this.state.captured&&Object(u.jsx)("div",{className:"imageCanvas",children:t}),a]})}}]),a}(n.Component),_=function(e){Object(U.a)(a,e);var t=Object(T.a)(a);function a(){var e;return Object(A.a)(this,a),(e=t.call(this)).captureImage=Object(l.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.webcam.takeBase64Photo({type:"jpeg",quality:.8}),console.log(a.base64),e.setState({captured:!0,capturedImage:a.base64});case 3:case"end":return t.stop()}}),t)}))),e.discardImage=function(){e.setState({captured:!1,capturedImage:null})},e.uploadImage=function(){if(e.props.offline){console.log("you're using in offline mode sha");var t=Math.random().toString(36).substr(2,5);localStorage.setItem("".concat("cloudy_pwa_").concat(t),e.state.capturedImage),alert("Image saved locally, it will be uploaded to your Sabhi media library once internet connection is detected"),e.discardImage()}else e.setState({uploading:!0}),g.sabhiApiInstance.post("ocr/cnic/front",{file:e.state.capturedImage,did:localStorage.getItem("DID")}).then((function(t){return e.checkUploadStatus(t)})).catch((function(t){alert("Sorry, we encountered an error uploading your image"),e.setState({uploading:!1})}))},e.findLocalItems=function(e){var t,a=[];for(t in localStorage)if(localStorage.hasOwnProperty(t)&&(t.match(e)||!e&&"string"===typeof t)){var n=localStorage.getItem(t);a.push({key:t,val:n})}return a},e.checkUploadStatus=function(t){e.setState({uploading:!1}),200===t.status?(alert("Image Uploaded to Sabhi Media Library"),e.discardImage()):alert("Sorry, we encountered an error uploading your image")},e.batchUploads=function(){var t=e.findLocalItems(/^cloudy_pwa_/);if(t.length>0){e.setState({uploading:!0});for(var a=0;a<t.length;a++)g.sabhiApiInstance.post("ocr/cnic/front",{file:t[a].val,did:localStorage.getItem("DID")}).then((function(t){return e.checkUploadStatus(t)})).catch((function(e){!0}));e.setState({uploading:!1}),alert("All saved images have been uploaded to your Sabhi Media Library")}},e.webcam=null,e.state={capturedImage:null,captured:!1,uploading:!1},e}return Object(q.a)(a,[{key:"componentDidMount",value:function(){this.canvasElement=document.createElement("canvas"),this.webcam=new P(document.getElementById("webcam"),this.canvasElement),this.webcam.setup().catch((function(){alert("Error getting access to your camera")}))}},{key:"componentDidUpdate",value:function(e){this.props.offline||!0!==e.offline||this.batchUploads()}},{key:"render",value:function(){var e={};this.state.captured&&(e.display="none");var t=this.state.capturedImage?Object(u.jsx)("img",{src:this.state.capturedImage,alt:"captured",width:"350"}):Object(u.jsx)("span",{}),a=this.state.captured?Object(u.jsxs)("div",{children:[Object(u.jsx)("button",{className:"deleteButton",onClick:this.discardImage,children:" Delete Photo "}),Object(u.jsx)("button",{className:"captureButton",onClick:this.uploadImage,children:" Upload Photo "})]}):Object(u.jsx)("button",{className:"captureButton",onClick:this.captureImage,children:" Take Picture "}),n=this.state.uploading?Object(u.jsx)("div",{children:Object(u.jsx)("p",{children:" Uploading Image, please wait ... "})}):Object(u.jsx)("span",{});return Object(u.jsxs)("div",{children:[Object(u.jsx)("h1",{children:" Back "}),n,Object(u.jsx)("video",{autoPlay:!0,playsInline:!0,muted:!0,id:"webcam",width:"100%",style:e}),Object(u.jsx)("br",{}),this.state.captured&&Object(u.jsx)("div",{className:"imageCanvas",children:t}),a]})}}]),a}(n.Component);function z(){return Object(u.jsx)("div",{className:"App",children:Object(u.jsxs)(i.c,{children:[Object(u.jsx)(i.a,{path:"/",component:m,exact:!0}),Object(u.jsx)(i.a,{path:"/onboard",component:B}),Object(u.jsx)(i.a,{path:"/ocr_front",component:F}),Object(u.jsx)(i.a,{path:"/ocr_back",component:_}),Object(u.jsx)(i.a,{path:"/form_sdr",component:f}),Object(u.jsx)(i.a,{path:"/user_profile",component:E})]})})}a(304),a(305),a(306),a(307);var L=a(50);c.a.render(Object(u.jsx)(L.a,{children:Object(u.jsx)(z,{})}),document.getElementById("root"))},34:function(e,t,a){var n=a(185),r=n.create({baseURL:"https://client-server-veramo.herokuapp.com/"}),c=n.create({baseURL:"https://sabhi-task.com/"});e.exports={apiInstance:r,sabhiApiInstance:c}}},[[308,1,2]]]);
//# sourceMappingURL=main.611f7080.chunk.js.map