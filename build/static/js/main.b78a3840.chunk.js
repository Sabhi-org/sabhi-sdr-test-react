(this["webpackJsonpsdr-form"]=this["webpackJsonpsdr-form"]||[]).push([[0],{118:function(e,t,a){},187:function(e,t,a){},316:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a(30),r=a.n(n),c=(a(187),a(94)),i=a(23),l=a(15),o=a.n(l),d=a(22),u=a.p+"static/media/dark.e4d8b6e7.svg",m=(a(118),a(3));function b(){var e=Object(i.f)();return Object(s.useEffect)((function(){var t=setTimeout(Object(d.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.push("/onboard");case 1:case"end":return t.stop()}}),t)}))),3e3);return function(){clearInterval(t)}}),[]),Object(m.jsx)("div",{class:"container",style:{display:"inline-flex",justifyContent:"center",alignItems:"center",width:"500px"},children:Object(m.jsx)("img",{src:u,width:"200px"})})}a(63);var j=a(29),p=(a(329),a(324),a(327),a(177)),h=a(319),g=a(325),f=a(320),O=a(321),x=a(326),y=(a(322),a(331),a(332),a(32));var v=a(330),I=a(328),w=a(323),N=a(84),D=a(333);function k(){var e,t=localStorage.getItem("DID"),a=Object(i.f)(),n=g.a.useForm(),r=Object(j.a)(n,1)[0],c=Object(s.useState)("false"),l=Object(j.a)(c,2),u=l[0],b=l[1],p=Object(s.useState)({}),k=Object(j.a)(p,2),S=k[0],E=k[1],C=function(){var e=Object(d.a)(o.a.mark((function e(){var a,s,n,c,i,l,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,b(!0),e.next=4,y.sabhiApiInstance.get("ocr/".concat(t));case 4:a=e.sent,s=a.data.data[0],n=s.identityCardFrontData,c=s.identityCardBackData,i=s.profileImage,l=s.identityCardFrontImage,d=s.identityCardBackImage,E({profileImage:i,identityCardFrontImage:l,identityCardBackImage:d}),r.setFieldsValue({fullName:n.nameEnglish,fatherName:n.fatherNameEnglish,gender:n.gender,countryOfStay:n.countryOfStay,identityNumber:n.identityNumber,issueDate:n.dateOfIssue,birthDate:n.dateOfBirth,expireDate:n.dateOfExpiry,permanentAddress:c.permenantAddress,temporaryAddress:c.presentAddress}),b(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();Object(s.useEffect)((function(){C()}),[]);var z=function(){var e=Object(d.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.apiInstance.post("vp",t);case 3:e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)("div",{children:Object(m.jsx)(v.b,{size:"large",children:Object(m.jsx)(h.a,{spinning:u,children:Object(m.jsxs)(g.a,{style:{marginTop:"18px"},layout:"vertical",form:r,name:"basic",onFinish:function(e){b(!0),e.profileImage=S.profileImage,e.did=t,e.identityCardBackImage=S.identityCardBackImage,e.identityCardFrontImage=S.identityCardFrontImage,z(e),b(!1),a.push({pathname:"/user_profile"})},onFinishFailed:function(e){console.log("Failed:",e)},children:[Object(m.jsxs)(f.a,{children:[Object(m.jsx)(O.a,{span:4,children:Object(m.jsx)(I.a,{style:{marginTop:"18px"},src:Object(m.jsx)(w.a,{src:null!==(e=S.profileImage)&&void 0!==e?e:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"}),size:140})}),Object(m.jsxs)(O.a,{span:20,children:[Object(m.jsxs)(f.a,{gutter:16,children:[Object(m.jsx)(O.a,{className:"gutter-row",span:2}),Object(m.jsx)(O.a,{className:"gutter-row",span:11,children:Object(m.jsx)(g.a.Item,{label:"Name",name:"fullName",rules:[{required:!0,message:"Please enter Complete Name"}],children:Object(m.jsx)(x.a,{size:"small"})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:11,children:Object(m.jsx)(g.a.Item,{label:"Father Name",name:"fatherName",rules:[{required:!0,message:"Please enter Father Name"}],children:Object(m.jsx)(x.a,{size:"small"})})})]}),Object(m.jsxs)(f.a,{gutter:16,offset:4,children:[Object(m.jsx)(O.a,{className:"gutter-row",span:2}),Object(m.jsx)(O.a,{className:"gutter-row",span:11,children:Object(m.jsx)(g.a.Item,{label:"Gender",name:"gender",rules:[{required:!0,message:"Please enter gender"}],children:Object(m.jsx)(x.a,{size:"small"})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:11,children:Object(m.jsx)(g.a.Item,{label:"Country of Stay",name:"countryOfStay",rules:[{required:!0,message:"Please enter the country of stay"}],children:Object(m.jsx)(x.a,{size:"small"})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:6})]})]})]}),Object(m.jsxs)(f.a,{children:[Object(m.jsxs)(f.a,{gutter:22,children:[Object(m.jsx)(O.a,{className:"gutter-row",span:6,children:Object(m.jsx)(g.a.Item,{label:"Identity Number",name:"identityNumber",rules:[{required:!0,message:"Enter the Identity Number"}],children:Object(m.jsx)(x.a,{size:"small"})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:6,children:Object(m.jsx)(g.a.Item,{label:"Date of Issue",name:"issueDate",rules:[{required:!0,message:"Enter Date of Issue"}],children:Object(m.jsx)(x.a,{size:"small"})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:6,children:Object(m.jsx)(g.a.Item,{label:"Date of Birth",name:"birthDate",rules:[{required:!0,message:"Enter Date of Birth"}],children:Object(m.jsx)(x.a,{size:"small"})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:6,children:Object(m.jsx)(g.a.Item,{label:"Date of Expiry",name:"expireDate",rules:[{required:!0,message:"Enter expiry Date"}],children:Object(m.jsx)(x.a,{size:"small"})})})]}),Object(m.jsxs)(O.a,{span:24,children:[Object(m.jsx)(g.a.Item,{label:"Permanent Address",name:"permanentAddress",rules:[{required:!0,message:"Please enter permanent address"}],children:Object(m.jsx)(x.a,{size:"small"})}),Object(m.jsx)(g.a.Item,{label:"Temporary Address",name:"temporaryAddress",rules:[{required:!0,message:"Please enter temporary address"}],children:Object(m.jsx)(x.a,{size:"small"})})]})]}),Object(m.jsx)(f.a,{children:Object(m.jsx)(O.a,{span:4,offset:10,children:Object(m.jsx)(g.a.Item,{children:Object(m.jsxs)(N.a,{type:"primary",htmlType:"submit",shape:"round",size:"large",block:!0,children:[Object(m.jsx)(D.a,{}),"Submit"]})})})})]})})})})}var S=a(174),E=a(129),C=a.n(E);function z(){var e,t=localStorage.getItem("DID");console.log(localStorage.getItem("DID"));var a=Object(s.useState)(""),n=Object(j.a)(a,2),r=(n[0],n[1]),c=g.a.useForm(),i=Object(j.a)(c,1)[0],l=Object(s.useState)("false"),u=Object(j.a)(l,2),b=u[0],N=u[1],D=Object(s.useState)(null),k=Object(j.a)(D,2),E=(k[0],k[1],Object(s.useState)({})),z=Object(j.a)(E,2),B=z[0],A=z[1];Object(s.useEffect)((function(){!function(){U.apply(this,arguments)}()}),[]);var F,P="";function U(){return(U=Object(d.a)(o.a.mark((function e(){var a,s,n,r,c,l,d,u,m,b,j,h,g;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,N(!0),e.next=4,y.sabhiApiInstance.get("application/".concat(t));case 4:a=e.sent,console.log(a.data.data[0]),s=a.data.data[0],n=s.fullName,r=s.fatherName,c=s.profileImage,l=s.countryOfStay,d=s.gender,u=s.identityNumber,m=s.issueDate,b=s.birthDate,j=s.expireDate,h=s.permanentAddress,g=s.temporaryAddress,A({profileImage:c}),i.setFieldsValue({fullName:n.value,fatherName:r.value,gender:d.value,countryOfStay:l.value,identityNumber:u.value,issueDate:m.value,birthDate:b.value,expireDate:j.value,permanentAddress:h.value,temporaryAddress:g.value}),N(!1),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),p.b.error("something went wrong!",e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}return Object(s.useEffect)((function(){F=Object(S.io)("http://localhost:12345/"),console.log(F),F.on("chat",(function(e){console.log(e)})),F.on("displayOmniCheck",(function(e){console.log(e),P=e.message,r(e.message),function(){var e=C.a.mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1});e.fire({title:"Please confirm following",html:"".concat(P),allowOutsideClick:!1,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, it is me",cancelButtonText:"No,it is not me",reverseButtons:!0}).then((function(t){t.isConfirmed?(console.log("i am confirmed !!! "),F.emit("omniResponse",{status:!0,message:"omni is accepted!"}),e.fire("Confirmed!","Your data has been confirmed","success")):t.dismiss===C.a.DismissReason.cancel&&(console.log("i am rejected !!!"),F.emit("omniResponse",{status:!1,message:"omni is rejected!"}),e.fire("Cancelled","Your data could not be confirmed :(","error"))}))}()}))}),[]),Object(m.jsx)("div",{children:Object(m.jsx)(v.b,{size:"large",children:Object(m.jsxs)(h.a,{spinning:b,children:[Object(m.jsxs)(g.a,{style:{marginTop:"18px"},layout:"vertical",form:i,name:"basic",children:[Object(m.jsxs)(f.a,{children:[Object(m.jsx)(O.a,{span:4,children:Object(m.jsx)(I.a,{style:{marginTop:"18px"},src:Object(m.jsx)(w.a,{src:null!==(e=B.profileImage)&&void 0!==e?e:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png"}),size:140})}),Object(m.jsxs)(O.a,{span:20,children:[Object(m.jsxs)(f.a,{gutter:16,children:[Object(m.jsx)(O.a,{className:"gutter-row",span:2}),Object(m.jsx)(O.a,{className:"gutter-row",span:11,children:Object(m.jsx)(g.a.Item,{label:"Name",name:"fullName",children:Object(m.jsx)(x.a,{size:"small",disabled:!0})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:11,children:Object(m.jsx)(g.a.Item,{label:"Father Name",name:"fatherName",children:Object(m.jsx)(x.a,{size:"small",disabled:!0})})})]}),Object(m.jsxs)(f.a,{gutter:16,offset:4,children:[Object(m.jsx)(O.a,{className:"gutter-row",span:2}),Object(m.jsx)(O.a,{className:"gutter-row",span:11,children:Object(m.jsx)(g.a.Item,{label:"Gender",name:"gender",children:Object(m.jsx)(x.a,{size:"small",disabled:!0})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:11,children:Object(m.jsx)(g.a.Item,{label:"Country of Stay",name:"countryOfStay",children:Object(m.jsx)(x.a,{size:"small",disabled:!0})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:6})]})]})]}),Object(m.jsxs)(f.a,{children:[Object(m.jsxs)(f.a,{gutter:22,children:[Object(m.jsx)(O.a,{className:"gutter-row",span:6,children:Object(m.jsx)(g.a.Item,{label:"Identity Number",name:"identityNumber",children:Object(m.jsx)(x.a,{size:"small",disabled:!0})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:6,children:Object(m.jsx)(g.a.Item,{label:"Date of Issue",name:"issueDate",children:Object(m.jsx)(x.a,{size:"small",disabled:!0})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:6,children:Object(m.jsx)(g.a.Item,{label:"Date of Birth",name:"birthDate",children:Object(m.jsx)(x.a,{size:"small",disabled:!0})})}),Object(m.jsx)(O.a,{className:"gutter-row",span:6,children:Object(m.jsx)(g.a.Item,{label:"Date of Expiry",name:"expireDate",children:Object(m.jsx)(x.a,{size:"small",disabled:!0})})})]}),Object(m.jsxs)(O.a,{span:24,children:[Object(m.jsx)(g.a.Item,{label:"Permanent Address",name:"permanentAddress",children:Object(m.jsx)(x.a,{size:"small",disabled:!0})}),Object(m.jsx)(g.a.Item,{label:"Temporary Address",name:"temporaryAddress",children:Object(m.jsx)(x.a,{size:"small",disabled:!0})})]})]})]}),Object(m.jsx)(f.a,{children:"Verified By: XYZ"})]})})})}var B=a.p+"static/media/onboarding.80f4a645.png";function A(){var e=Object(i.f)(),t=function(){var t=Object(d.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{p.b.loading("creating identity...",.5).then(Object(d.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.apiInstance.get("did");case 2:(a=t.sent)&&(localStorage.setItem("DID",a.data.did),console.log(localStorage.getItem("DID")),p.b.success("Identity created succesfully!").then((function(){return p.b.loading("redirecting...",1).then((function(){return e.push("/ocr")}))})));case 4:case"end":return t.stop()}}),t)}))))}catch(a){p.b.error("something went wrong please try again!")}case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(m.jsxs)("div",{class:"container",style:{display:"inline-flex",justifyContent:"center",alignItems:"center",width:"500px",height:"500px"},children:[Object(m.jsx)("img",{src:B,width:"200px"}),Object(m.jsx)(N.a,{type:"primary",shape:"round",style:{position:"absolute",top:"550px",background:"#4DDFBC",bordeRadius:"16px",borderColor:"#4DDFBC"},size:"large",onClick:t,children:"Create Identity"})]})}var F=a(110),P=a(111),U=a(181),q=a(176),T=function(){function e(t,a){Object(F.a)(this,e),this.webcamElement=t,this.canvasElement=a}return Object(P.a)(e,[{key:"adjustVideoSize",value:function(e,t){var a=e/t;e>=t?this.webcamElement.width=a*this.webcamElement.height:e<t&&(this.webcamElement.height=this.webcamElement.width/a)}},{key:"setup",value:function(){var e=Object(d.a)(o.a.mark((function e(){var t=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){void 0!==navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}}).then((function(e){"srcObject"in t.webcamElement?(t.webcamElement.srcObject=e,console.log("here")):t.webcamElement.src=window.URL.createObjectURL(e),t.webcamElement.onloadedmetadata=function(e){t.webcamElement.play()}})):a()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_drawImage",value:function(){var e=this.webcamElement.videoWidth,t=this.webcamElement.videoHeight,a=this.canvasElement.getContext("2d");return this.canvasElement.width=e,this.canvasElement.height=t,a.drawImage(this.webcamElement,0,0,e,t),{imageHeight:t,imageWidth:e}}},{key:"takeBlobPhoto",value:function(){var e=this,t=this._drawImage(),a=t.imageWidth,s=t.imageHeight;return new Promise((function(t,n){e.canvasElement.toBlob((function(e){t({blob:e,imageHeight:s,imageWidth:a})}))}))}},{key:"takeBase64Photo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"png",quality:1},t=e.type,a=e.quality,s=this._drawImage(),n=s.imageHeight,r=s.imageWidth,c=this.canvasElement.toDataURL("image/"+t,a);return{base64:c,imageHeight:n,imageWidth:r}}}]),e}(),L=function(e){Object(U.a)(a,e);var t=Object(q.a)(a);function a(){var e;return Object(F.a)(this,a),(e=t.call(this)).captureImage=Object(d.a)(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=e.webcam.takeBase64Photo({type:"jpeg",quality:.8}),console.log(a.base64),e.setState({captured:!0,capturedImage:a.base64});case 3:case"end":return t.stop()}}),t)}))),e.discardImage=function(){e.setState({captured:!1,capturedImage:null})},e.uploadImage=function(){if(e.props.offline){console.log("you're using in offline mode sha");var t=Math.random().toString(36).substr(2,5);localStorage.setItem("".concat("cloudy_pwa_").concat(t),e.state.capturedImage),alert("Image saved locally, it will be uploaded to your Sabhi media library once internet connection is detected"),e.discardImage()}else e.setState({uploading:!0}),y.sabhiApiInstance.post("ocr/cnic/front",{file:e.state.capturedImage,did:localStorage.getItem("DID")}).then((function(t){return e.checkUploadStatus(t)})).catch((function(t){alert("Sorry, we encountered an error uploading your image"),e.setState({uploading:!1})}))},e.findLocalItems=function(e){var t,a=[];for(t in localStorage)if(localStorage.hasOwnProperty(t)&&(t.match(e)||!e&&"string"===typeof t)){var s=localStorage.getItem(t);a.push({key:t,val:s})}return a},e.checkUploadStatus=function(t){e.setState({uploading:!1}),200===t.status?(alert("Image Uploaded to Sabhi Media Library"),e.discardImage()):alert("Sorry, we encountered an error uploading your image")},e.batchUploads=function(){var t=e.findLocalItems(/^cloudy_pwa_/);if(t.length>0){e.setState({uploading:!0});for(var a=0;a<t.length;a++)y.sabhiApiInstance.post("ocr/cnic/front",{file:t[a].val,did:localStorage.getItem("DID")}).then((function(t){return e.checkUploadStatus(t)})).catch((function(e){!0}));e.setState({uploading:!1}),alert("All saved images have been uploaded to your Sabhi Media Library")}},e.webcam=null,e.state={capturedImage:null,captured:!1,uploading:!1},e}return Object(P.a)(a,[{key:"componentDidMount",value:function(){this.canvasElement=document.createElement("canvas"),this.webcam=new T(document.getElementById("webcam"),this.canvasElement),this.webcam.setup().catch((function(){alert("Error getting access to your camera")}))}},{key:"componentDidUpdate",value:function(e){this.props.offline||!0!==e.offline||this.batchUploads()}},{key:"render",value:function(){var e={};this.state.captured&&(e.display="none");var t=this.state.capturedImage?Object(m.jsx)("img",{src:this.state.capturedImage,alt:"captured",width:"350"}):Object(m.jsx)("span",{}),a=this.state.captured?Object(m.jsxs)("div",{children:[Object(m.jsx)("button",{className:"deleteButton",onClick:this.discardImage,children:" Delete Photo "}),Object(m.jsx)("button",{className:"captureButton",onClick:this.uploadImage,children:" Upload Photo "})]}):Object(m.jsx)("button",{className:"captureButton",onClick:this.captureImage,children:" Take Picture "}),s=this.state.uploading?Object(m.jsx)("div",{children:Object(m.jsx)("p",{children:" Uploading Image, please wait ... "})}):Object(m.jsx)("span",{});return Object(m.jsxs)("div",{children:[Object(m.jsx)("h1",{children:" Front"}),s,Object(m.jsx)("video",{autoPlay:!0,playsInline:!0,muted:!0,id:"webcam",width:"100%",style:e}),Object(m.jsx)("br",{}),this.state.captured&&Object(m.jsx)("div",{className:"imageCanvas",children:t}),a]})}}]),a}(s.Component);function _(){return Object(m.jsx)("div",{className:"App",style:Object(c.a)({background:"rgb(95, 130, 189)"},"background","linear - gradient(180deg, rgba(95, 130, 189, 1) 0 %, rgba(47, 77, 125, 1) 100 %)"),children:Object(m.jsxs)(i.c,{children:[Object(m.jsx)(i.a,{path:"/",component:b,exact:!0}),Object(m.jsx)(i.a,{path:"/onboard",component:A}),Object(m.jsx)(i.a,{path:"/ocr",component:L}),Object(m.jsx)(i.a,{path:"/form_sdr",component:k}),Object(m.jsx)(i.a,{path:"/user_profile",component:z})]})})}a(312),a(313),a(314),a(315);var R=a(56);r.a.render(Object(m.jsx)(R.a,{children:Object(m.jsx)(_,{})}),document.getElementById("root"))},32:function(e,t,a){var s=a(193),n=s.create({baseURL:"https://client-server-veramo.herokuapp.com/"}),r=s.create({baseURL:"https://sabhi-task.com/"});e.exports={apiInstance:n,sabhiApiInstance:r}}},[[316,1,2]]]);
//# sourceMappingURL=main.b78a3840.chunk.js.map